define(["ojs/ojcore","knockout","jquery","appController","util/appui","pages/common/constant","pages/common/cartService","pages/delivery/deliveryService","pages/common/maintenance","ojs/ojrouter","ojs/ojknockout","ojs/ojinputtext","ojs/ojbutton","ojs/ojinputnumber","ojs/ojselectcombobox",,"ojs/ojnavigationlist","promise","ojs/ojcollapsible"],function(e,o,r,n,t,a,i,s,l){function u(){function r(e){var o=n.moduleConfig.params.rootContext.userProfile;try{o.salesRole===a.SR_ADMIN&&(n.moduleConfig.params.rootContext.selOrgUnitId=new String(e).valueOf(),n.moduleConfig.params.rootContext.userProfile.orgUnitId=new String(e).valueOf(),n.moduleConfig.params.rootContext.refreshCustomerList=!0)}catch(e){}finally{g.dummy.notifySubscribers()}}function u(){var e=i.getOfflineKey(),r=t.getLocalStorage(e);return console.log("dataJSON="+o.toJS(r)),"undefined"!=typeof r?(Array.isArray(r)||(r=o.utils.unwrapObservable(r)),0==r.length?0:r.data.length):0}function c(){var e=s.getOfflineKey(),r=t.getLocalStorage(e);return"undefined"!=typeof r?(Array.isArray(r)||(r=o.utils.unwrapObservable(r)),0==r.length?0:r.data.length):0}function d(){var o=n.moduleConfig.params.rootContext.userProfile,r=e.Translations.getTranslatedString;g.lng_pickupList="",g.lng_hi=r("ssa.springboard.hi"),g.lng_customer=r("ssa.springboard.customer"),g.lng_visitation=r("ssa.springboard.visitation"),g.lng_stockInquiry=r("ssa.springboard.stockInquiry"),g.lng_performance=r("ssa.springboard.performance"),o.salesRole==a.SR_SALE_VAN?g.lng_pickupList=r("ssa.springboard.deliveryList"):g.lng_pickupList=r("ssa.springboard.pickupList"),g.lng_loadingList=r("ssa.springboard.loadingList"),g.lng_reviewLoadingList=r("ssa.springboard.reviewLoadingList"),g.lng_dailyReceipt=r("ssa.springboard.dailyReceipt"),g.lng_dailyOrders=r("ssa.springboard.dailyOrders"),g.lng_printerSetup=r("ssa.springboard.printerSetup"),g.lng_error_00005=r("ssa.msg.error.ERROR_00005"),g.lng_maintenance=r("ssa.msg.info.maintenance"),g.lng_reInitiateOrderList=r("ssa.springboard.reInitiateOrderList"),g.lng_schedule=r("ssa.springboard.schedule"),g.lng_logisticsSchMaint=r("ssa.schedule.logistic.title"),g.lng_nonWorkingDateMaint=r("ssa.schedule.nonWorkingDate.title"),g.lng_cutoffMaint=r("ssa.schedule.cutoff.title"),g.lng_earlierCutoffMaint=r("ssa.schedule.earlierCutOff.title")}var g=this,f=e.Translations.getTranslatedString;n.moduleConfig.params.rootContext.fromPage="springboard",n.moduleConfig.params.rootContext.isDataSync=!1,n.moduleConfig.params.rootContext.savedOrder=null,n.moduleConfig.params.rootContext.savedOrderLine=null,g.buildVersion=o.observable(n.moduleConfig.params.rootContext.buildVersion+" ("+n.moduleConfig.params.rootContext.environment+")"),g.dummy=o.observable(),g.role=o.observable(),g.displayName=o.observable(),g.licenseNo=o.observable(""),g.clickedSchedule=o.observable(!0);var m=e.ResponsiveUtils.getFrameworkQuery(e.ResponsiveUtils.FRAMEWORK_QUERY_KEY.LG_UP);g.large=e.ResponsiveKnockoutUtils.createMediaQueryObservable(m),g.orgUnit=o.observable(),g.availableOrgUnits=o.observableArray([{value:a.ORG_UNIT_ID_WINE,label:f("ssa.springboard.userRoleMSW")},{value:a.ORG_UNIT_ID_BEER,label:f("ssa.springboard.userRoleMSB")}]),"undefined"==typeof n.moduleConfig.params.rootContext.selOrgUnitId?(g.orgUnit(a.ORG_UNIT_ID_WINE),r(a.ORG_UNIT_ID_WINE)):(g.orgUnit(n.moduleConfig.params.rootContext.selOrgUnitId),r(n.moduleConfig.params.rootContext.selOrgUnitId)),g.orgUnit.subscribe(function(e){console.log("newOrgUnit="+e),r(e)}),g.displayScheduleOptions=o.computed(function(){var e=n.moduleConfig.params.rootContext.userProfile;try{return e.salesRole===a.SR_ADMIN&&g.clickedSchedule()}catch(e){return!1}}),g.customerListEnabled=o.computed(function(){var e=n.moduleConfig.params.rootContext.userProfile;try{var o=e.salesRole;return o===a.SR_SALE_VAN||o===a.SR_MOBILE_SALE||o===a.SR_ADMIN}catch(e){return!1}}),g.performanceEnabled=o.computed(function(){var e=n.moduleConfig.params.rootContext.userProfile;try{var o=e.salesRole;return o===a.SR_SALE_VAN||o===a.SR_MOBILE_SALE}catch(e){return!1}}),g.pickupEnabled=o.computed(function(){var e=n.moduleConfig.params.rootContext.userProfile;try{var o=e.salesRole;return o===a.SR_SALE_VAN||o===a.SR_DRIVER_JLOG||o===a.SR_DRIVER_LINDE}catch(e){return!1}}),g.loadingEnabled=o.computed(function(){var e=n.moduleConfig.params.rootContext.userProfile;try{return e.salesRole===a.SR_ADMIN_JLOG||e.salesRole===a.SR_DRIVER_JLOG||e.salesRole===a.SR_DRIVER_LINDE}catch(e){return!1}}),g.reviewLoadingEnabled=o.computed(function(){var e=n.moduleConfig.params.rootContext.userProfile;try{return e.salesRole===a.SR_ADMIN_LINDE}catch(e){return!1}}),g.scheduleEnabled=o.computed(function(){var e=n.moduleConfig.params.rootContext.userProfile;try{return e.salesRole===a.SR_ADMIN}catch(e){return!1}}),g.dailyReceptEnabled=o.computed(function(){var e=n.moduleConfig.params.rootContext.userProfile;try{var o=e.salesRole;return o===a.SR_SALE_VAN}catch(e){return!1}}),g.dailyOrderSummaryEnabled=o.computed(function(){var e=n.moduleConfig.params.rootContext.userProfile;try{var o=e.salesRole;return o===a.SR_SALE_VAN||o===a.SR_MOBILE_SALE}catch(e){return!1}}),g.visitationEnabled=o.computed(function(){n.moduleConfig.params.rootContext.userProfile;try{return!1}catch(e){return!1}}),g.stockInquiryEnabled=o.computed(function(){var e=n.moduleConfig.params.rootContext.userProfile;try{var o=e.salesRole,r=e.orgUnitId;return o===a.SR_MOBILE_SALE&&r===a.ORG_UNIT_ID_WINE||o===a.SR_ADMIN}catch(e){return!1}}),g.isDataSyncEnabled=o.computed(function(){var e=n.moduleConfig.params.rootContext.userProfile;try{var o=e.salesRole;return o===a.SR_MOBILE_SALE||o===a.SR_SALE_VAN||o===a.SR_ADMIN}catch(e){return!1}}),g.isPrinterSetupEnabled=o.computed(function(){var e=n.moduleConfig.params.rootContext.userProfile;try{var o=e.salesRole;if(o===a.SR_SALE_VAN)return!0}catch(e){return!1}}),g.isOrderDeskAdmin=o.computed(function(){var e=n.moduleConfig.params.rootContext.userProfile;try{return e.salesRole===a.SR_ADMIN}catch(e){return!1}}),g.isJLogAdmin=o.computed(function(){var e=n.moduleConfig.params.rootContext.userProfile;try{return e.salesRole===a.SR_ADMIN_JLOG}catch(e){return!1}}),g.isLindeAdmin=o.computed(function(){var e=n.moduleConfig.params.rootContext.userProfile;try{return e.salesRole===a.SR_ADMIN_LINDE}catch(e){return!1}}),g.reInitiateOrderEnabled=o.computed(function(){return g.isOrderDeskAdmin()}),g.userRole=o.computed(function(){var e,o=n.moduleConfig.params.rootContext.userProfile;try{o.salesRole===a.SR_SALE_VAN?e=f("ssa.springboard.userRoleVS"):o.salesRole===a.SR_MOBILE_SALE?o.orgUnitId===a.ORG_UNIT_ID_WINE?e=f("ssa.springboard.userRoleMSW"):o.orgUnitId===a.ORG_UNIT_ID_BEER&&(e=f("ssa.springboard.userRoleMSB")):o.salesRole===a.SR_ADMIN?e=f("ssa.springboard.userRoleADM"):o.salesRole===a.SR_ADMIN_JLOG?e=f("ssa.springboard.userRoleJLA"):o.salesRole!==a.SR_DRIVER_JLOG&&o.salesRole!==a.SR_DRIVER_LINDE||(e=f("ssa.springboard.userRoleDRIVER"))}catch(e){}return e}),g.handleActivated=function(e){var o=e.valueAccessor().params.ojRouter.parentRouter;console.log("springboard parentRouter="+o.currentState().value);var r=n.moduleConfig.params.rootContext.userProfile;"undefined"!=typeof r&&(g.displayName(r.displayName),g.role(r.role),"undefined"!=typeof r.licenseNo&&r.licenseNo?g.licenseNo("("+r.licenseNo+")"):g.licenseNo("")),d()},g.quotationList=function(e,o){n.router.go("quotation")},g.customer=function(e,o){n.router.go("customer")},g.visitation=function(e,o){n.router.go("visitation")},g.stockInquiry=function(e,o){var r=l.isMaintenance();if(r)return void t.showMessageBox(g.lng_maintenance);var a=n.moduleConfig.params.rootContext.isOnline;a?n.router.go("stockInquiry"):t.showMessageBox(g.lng_error_00005)},g.performance=function(e,o){var r=l.isMaintenance();if(r)return void t.showMessageBox(g.lng_maintenance);var a=n.moduleConfig.params.rootContext.isOnline;a?n.router.go("performance"):t.showMessageBox(g.lng_error_00005)},g.pickup=function(e,o){n.moduleConfig.params.rootContext.fromPage="springboard",n.router.go("pickup")},g.loading=function(e,o){var r=l.isMaintenance();return r?void t.showMessageBox(g.lng_maintenance):void n.router.go("loading")},g.reviewLoading=function(e,o){var r=l.isMaintenance();return r?void t.showMessageBox(g.lng_maintenance):void n.router.go("reviewLoading")},g.schedule=function(e,o){g.clickedSchedule(!g.clickedSchedule())},g.logisticsSchMaint=function(e,o){var r=l.isMaintenance();return r?void t.showMessageBox(g.lng_maintenance):void n.router.go("logisticsSchMaint")},g.nonWorkingDateMaint=function(e,o){var r=l.isMaintenance();return r?void t.showMessageBox(g.lng_maintenance):void n.router.go("nonWorkingDateMaint")},g.cutoffMaint=function(e,o){var r=l.isMaintenance();return r?void t.showMessageBox(g.lng_maintenance):void n.router.go("routeCutoffMaint")},g.earlierCutoffMaint=function(e,o){var r=l.isMaintenance();return r?void t.showMessageBox(g.lng_maintenance):void n.router.go("routeEarlierCutoffMaint")},g.dailyReceipt=function(e,o){var r=l.isMaintenance();if(r)return void t.showMessageBox(g.lng_maintenance);var a=n.moduleConfig.params.rootContext.isOnline;a?n.router.go("dailyReceipt"):t.showMessageBox(g.lng_error_00005)},g.dailyOrders=function(e,o){var r=l.isMaintenance();if(r)return void t.showMessageBox(g.lng_maintenance);var a=n.moduleConfig.params.rootContext.isOnline;a?(n.moduleConfig.params.rootContext.requireRefresh=!0,n.router.go("dailyOrders")):(n.moduleConfig.params.rootContext.requireRefresh=!1,t.showMessageBox(g.lng_error_00005))},g.reInitiateOrderList=function(e,o){n.router.go("reInitateOrder")},g.salesCustomer=function(e,o){n.router.go("salescustomer")},g.printerSetup=function(e,o){n.router.go("printerSetup")},g.getDataSyncCount=o.computed(function(){var e=0,o=0;return g.dummy(),e=u(),o=c(),e+o})}return o.bindingHandlers.fadeVisible={init:function(e,n){var t=n();r(e).toggle(o.unwrap(t))},update:function(e,n){var t=n();o.unwrap(t)?r(e).fadeIn():r(e).fadeOut()}},u});