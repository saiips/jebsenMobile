define(["ojs/ojcore","knockout","jquery","appController","util/appui","util/dataService","pages/stockDetail/stockDetailService","pages/common/constant","ojs/ojknockout","ojs/ojlistview","ojs/ojjsontreedatasource","ojs/ojnavigationlist","promise","ojs/ojtoolbar"],function(e,t,o,r,n,s,a,i){function u(){function s(e){var s=r.moduleConfig.params.rootContext.userProfile,i=u.router.parent.moduleConfig.params.selectedStockItem;u.currStock=i;var l=i.ORG_ID,c=i.ITEM_ID,v=i.SUBINVENTORY,I=i.LOT,d={InputGetItemReservationDetails:{HeaderInfo:{UserID:s.username,UserRole:s.salesRole,CallerID:""},P_ORG_ID:l,P_ITEM_ID:c,P_ITEM_SUBINV:v,LOT:I}};d=JSON.stringify(d),console.log("InputGetItemReservationDetails payload = "+d),n.showBusy(),a.getItemReservationDetailsMessage(d).then(function(e){n.hideBusy();var r=e;if(console.log("ReservationDetails respJSON="+t.toJSON(r)),"string"==typeof e&&(r=JSON.parse(e)),r.P_RESERVATION_TBL){u.reservationEnabled(!0);var s=r.P_RESERVATION_TBL.P_RESERVATION_TBL_ITEM;o.isArray(s)||(s=new Array(s)),u.reservationList(s)}},function(e){})}function i(){var t=e.Translations.getTranslatedString;u.lng_stockInquiryResult=t("ssa.stockInquiryResult.detail.stockInquiryResult"),u.lng_description=t("ssa.stockInquiryResult.description"),u.lng_subInventory=t("ssa.stockInquiryResult.subInventory"),u.lng_lot=t("ssa.stockInquiryResult.lot"),u.lng_onhand=t("ssa.stockInquiryResult.onhand"),u.lng_reservation=t("ssa.stockInquiryResult.reservation"),u.lng_available=t("ssa.stockInquiryResult.available"),u.lng_overview=t("ssa.stockInquiryResult.detail.overview"),u.lng_reservationStatus=t("ssa.stockInquiryResult.detail.reservationStatus")}var u=this;u.router=r.router,u.handleActivated=function(t){u.parentRouter=t.valueAccessor().params.ojRouter.parentRouter,console.log("stockDetail parentRouter="+u.parentRouter.currentState().value);var o=u.parentRouter.getChildRouter("stockDetail");return o||(o=u.parentRouter.createChildRouter("stockDetail")),u.router=o.configure(function(t){if(t){var o=new e.RouterState(t,{value:t,enter:function(){s(t),console.log("stockDetail stateId = "+t)}});return o}}),i(),e.Router.sync()},u.handleAttached=function(e){},u.handleBindingsApplied=function(e){},u.handleDetached=function(e){},u.handleTransitionCompleted=function(e){},u.dispose=function(e){u.router.dispose()},u.goBack=function(){u.parentRouter.go("stockList")},u.currStockId=t.observable(),u.currStock=t.observable(),u.reservationList=t.observableArray(),u.reservations=t.computed(function(){if(u.reservationList().length>0)return new e.ArrayTableDataSource(u.reservationList(),{idAttribute:"ITEM_ID"})}),u.reservationEnabled=t.observable(!1),u.currStockId.subscribe(function(e){s(e)})}return u});