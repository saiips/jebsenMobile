define(["knockout","jquery","module","amplify","pages/common/constant","util/devmode","util/appui","util/commonhelper"],function(e,t,o,n,s,a,u,i){function r(){function o(o,r){var l=t.Deferred();console.log("Quotation List payload : "+e.toJS(o));var c=e.utils.parseJson(o),f=c.InputGetQuotation.P_ORG_ID,g=c.InputGetQuotation.P_SHIP_TO_ORG_ID,I=s.QUOTATION_LIST_KEY+":"+f+":"+g;if(a.isEnabled()&&a.isOffline())return t.getJSON("js/app/pages/quotation/quotationMock.json",function(e){setTimeout(function(){l.resolve(e,{status:200})},500)}),t.when(l);var p=u.getLocalStorage(I);return p&&!r?(console.log("[Local Storage] Quotation List - "+I),l.resolve(p,{status:200})):(console.log("[Amplify Request] Quotation List - "+I),n.request({resourceId:s.QUOTATION_LIST_KEY,success:l.resolve,error:l.reject,data:o}),u.setLocalStorage(I+":"+s.QUOTATION_LIST_SYNC_DATETIME,i.getClientCurrentDate(s.DATETIME_FORMAT).toUpperCase()),t.when(l).done(function(e,t,o){u.setLocalStorage(I,e)})),t.when(l)}function r(o){var i=t.Deferred();console.log("Quotation Line payload : "+e.toJS(o));var r=e.utils.parseJson(o),l=r.InputGetQuotationLines.P_ORG_ID,c=r.InputGetQuotationLines.P_HEADER_ID,f=s.QUOTATION_DETAIL_KEY+":"+l+":"+c;if(a.isEnabled()&&a.isOffline())return t.getJSON("js/app/pages/quotation/quotationLineMock.json",function(e){setTimeout(function(){i.resolve(e,{status:200})},500)}),t.when(i);var g=u.getLocalStorage(f);return g?(console.log("[Local Storage] Quotation Line - "+f),i.resolve(g,{status:200})):(console.log("[Amplify Request] Quotation Line - "+f),n.request({resourceId:s.QUOTATION_DETAIL_KEY,success:i.resolve,error:i.reject,data:o}),t.when(i).done(function(e,t,o){u.setLocalStorage(f,e)})),t.when(i)}this.getQuotationHistMessage=function(e){return o(e,!1)},this.refreshQuotationHistMessage=function(e){return o(e,!0)},this.getQuotationItemMessage=function(e){return r(e)}}return new r});