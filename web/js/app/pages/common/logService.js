define(["moment","knockout","jquery","amplify","pages/common/constant","config/appconfig","appController"],function(e,t,n,o,r,s,a){function i(){this.getEventLogPayload=function(t,n,o,r){var i=a.moduleConfig.params.rootContext.userProfile.salesRole,m=s.get("environment"),l=new String(e(new Date).format("YYYYMMDD")),u=(new Date).toISOString(),c=JSON.stringify({InputCreateEvent:{HeaderInfo:{UserID:t,UserRole:i,CallerID:""},Event:n,Payload:o,AdditionalInfo:r,LogDate:l,Environment:m,User:t,EventDate:u}});return c},this.getPayload=function(e,t){var n=mcs._Utils.uuid(),o=(new Date).toISOString(),r=mcs.MobileBackendManager.platform.getDeviceInformation(),s=mcs.MobileBackendManager.platform.getGPSLocation(),a=JSON.stringify([{name:"context",timestamp:o,properties:{timezone:""+60*(new Date).getTimezoneOffset(),model:r.model,manufacturer:r.maufacturer,osName:r.osName,osVersion:r.osVersion,osBuild:r.osBuild,carrier:r.carrier,latitude:s.latitude,longitude:s.longitude},type:"system"},{name:"sessionStart",timestamp:o,properties:{},sessionID:n,type:"system"},{name:e,timestamp:o,properties:t,type:"custom",sessionID:n}]);return a},this.log=function(e){var t=n.Deferred(),a=r.EVENT_LOG_KEY,i=s.get("environment");return"prd"!=i?t.resolve({status:200}):(console.log("[Amplify Request] Log Event Request - "+a),o.request({resourceId:a,success:t.resolve,error:t.reject,data:e})),n.when(t)}}return new i});