define(["ojs/ojcore","knockout","jquery","appController","util/data","util/appui","pages/dailyReceipt/dailyReceiptService","pages/common/constant","util/commonhelper","ojs/ojrouter","ojs/ojknockout","ojs/ojinputtext","ojs/ojbutton","ojs/ojinputnumber","ojs/ojselectcombobox","ojs/ojlistview","ojs/ojmodel","ojs/ojpagingcontrol","ojs/ojpagingcontrol-model","ojs/ojpulltorefresh","ojs/ojvalidation","ojs/ojoffcanvas"],function(e,o,t,a,r,s,n,i,l){function u(){function r(){console.log("dailyReceipt.js init() started");var e=a.moduleConfig.params.rootContext.isOnline;if(!e)return void s.showMessageBox(d.lng_error_00005);s.showBusy();var t=function(e,o){try{i(e,o.status)}catch(e){console.error(e),s.hideBusy()}finally{console.log("cbSuccessFn called"),s.hideBusy()}},r=function(e,o){console.log("cbFailFn failed"),i(e,o.status)},l=c();console.log("daily receipt summary payload = "+o.toJS(l)),n.getDailyReceiptMessage(l).then(t,r)}function i(t,a){if(console.log("raw data = "+o.toJSON(t)),t=Array.isArray(t)?t[0]:t,null!==t&&200==a){var r=0,s=o.observableArray([]),n=t.OutputGetVanOrderSummary;o.utils.arrayMap(n,function(e){var t=l.formatStrDate(e.OrderDate,"YYYY-MM-DDTHH:mm:ssZ","YYYY/MM/DD");if(l.isDateFormat(t,"YYYY/MM/DD")){var a=e.TotalChequeAmount,n=e.TotalCashAmount,i=e.TotalOthersAmount;s.push(o.toJS({id:r,date:t,chequeAmount:a,cashAmount:n,othersAmount:i})),r++}}),d.worklistData(new e.ArrayTableDataSource(s,{idAttribute:"id"}))}}function u(){var o=e.Translations.getTranslatedString;d.lng_searchPlaceHolder=o("ssa.header.search"),d.lng_dailyReceiptSummary=o("ssa.dailyReceipt.dailyReceiptSummary"),d.lng_date=o("ssa.dailyReceipt.date"),d.lng_chequeAmount=o("ssa.dailyReceipt.chequeAmount"),d.lng_cashAmount=o("ssa.dailyReceipt.cashAmount"),d.lng_byCheque=o("ssa.dailyReceipt.byCheque"),d.lng_byCash=o("ssa.dailyReceipt.byCash"),d.lng_byOthers=o("ssa.dailyReceipt.byOthers"),d.lng_error_00005=o("ssa.msg.error.ERROR_00005")}function c(){var e=a.moduleConfig.params.rootContext.userProfile,o=l.getClientDays(-7,"YYYY-MM-DDTHH:mm:ssZ"),t=l.getClientCurrentDate("YYYY-MM-DDTHH:mm:ssZ"),r=JSON.stringify({InputGetVanOrderSummary:{HeaderInfo:{UserID:e.username,UserRole:e.salesRole,CallerID:""},DateFrom:o,DateTo:t}});return r}var d=this;console.log("DailyReceiptViewModel"),d.router=a.router,d.worklistData=o.observable(),d.searchText=o.observable(""),d.searchText.extend({rateLimit:{timeout:500,method:"notifyWhenChangesStop"}}),d.searchValueComplete=o.observable(""),d.handleActivated=function(o){var t=o.valueAccessor().params.ojRouter.parentRouter;console.log("dailyReceipt.js parentRouter="+t.currentState().value);var a=t.getChildRouter("dailyReceipt");return a||(a=t.createChildRouter("dailyReceipt")),d.router=a.configure(function(o){if(o){var t=new e.RouterState(o,{value:o,enter:function(){console.log("dailyReceipt.js stateId="+o)}});return t}}),e.Router.sync()},d.handleBindingsApplied=function(e){var o=t("#globalBody").find(".oj-hybrid-applayout-content"),a="oj-hybrid-applayout-scrollable";o.hasClass(a)&&(t("#searchCanvas").on("ojbeforeopen",function(){o.removeClass(a)}),t("#searchCanvas").on("ojbeforeclose",function(){o.addClass(a)})),t("#searchCanvas").on("ojclose",function(){d.clearSearch()})},d.goBack=function(){a.router.go("springboard")},d.dispose=function(e){d.router.dispose()},u(),r()}var c;return c={selector:"#searchCanvas",edge:"top",displayMode:"push",size:"63px",modality:"modeless",autoDismiss:"none"},o.bindingHandlers.currency={symbol:o.observable("$"),update:function(e,t,a){return o.bindingHandlers.text.update(e,function(){var e=+(o.utils.unwrapObservable(t())||0),r=o.utils.unwrapObservable(void 0===a().symbol?a().sybmol:"$");return r+e.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")})}},u});