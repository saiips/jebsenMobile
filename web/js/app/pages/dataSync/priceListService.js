define(["knockout","jquery","amplify","util/appui","util/devmode","appController","pages/common/constant","util/commonhelper"],function(e,t,r,n,o,i,_,u){function I(){function u(e){return e==_.ORG_UNIT_ID_WINE?_.PRICE_ID_WINE:e==_.ORG_UNIT_ID_WINE?_.PRICE_ID_BEER:0}function I(e){var t=null,r=0;e?(t=e,r=u(e)):(t=i.moduleConfig.params.rootContext.userProfile.orgUnitId,r=u(t));var n=i.moduleConfig.params.rootContext.userProfile,o=[],_=[];o.push(r);for(var I=0;I<o.length;I++)_.push({PRICE_LIST_ID:o[I]});var s=JSON.stringify({InputGetPriceList:{HeaderInfo:{UserID:n.username,UserRole:n.salesRole,CallerID:""},P_ORG_ID:t,P_PRICE_LIST_ID_TBL:{P_PRICE_LIST_ID_TBL_ITEM:_}}});return s}function s(i){var u=t.Deferred(),s=null;s=i?i:I(),console.log("payload = "+e.toJS(s));var a=e.utils.parseJson(s),l=a.InputGetPriceList.P_ORG_ID,c=a.InputGetPriceList.P_PRICE_LIST_ID_TBL.P_PRICE_LIST_ID_TBL_ITEM[0].PRICE_LIST_ID,R=_.STANDARD_PRICE_LIST_KEY+":"+l+":"+c;o.isEnabled()&&o.isOffline()?t.getJSON("js/app/pages/dataSync/priceListMock.json",function(e){setTimeout(function(){u.resolve(e,{status:200})},500)}):(console.log("[Amplify Request] Standard Price List - "+R),r.request({resourceId:_.STANDARD_PRICE_LIST_KEY,success:u.resolve,error:u.reject,data:s}),t.when(u).done(function(e,t,r){n.setLocalStorage(R,e),n.updateDownloadRequestCount(_.P_STANDARD_PRICE_CNT,1)}).fail(function(){n.updateDownloadRequestCount(_.P_STANDARD_PRICE_CNT,1)}))}this.registerService=function(){return s(null)},this.registerWineService=function(){var e=I(_.ORG_UNIT_ID_WINE);return s(e)},this.registerBeerService=function(){var e=I(_.ORG_UNIT_ID_BEER);return s(e)},this.getData=function(e){return n.getLocalStorage(e)}}return new I});