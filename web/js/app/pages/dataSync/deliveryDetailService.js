define(["knockout","jquery","amplify","util/appui","util/devmode","appController","pages/common/constant","util/commonhelper"],function(e,t,n,o,i,r,u,s){function l(){function r(r){var s=t.Deferred(),l=e.utils.parseJson(r),a=l.InputGetShipmentDetails.HeaderInfo.UserID,p=l.InputGetShipmentDetails.HeaderInfo.UserRole,D=l.InputGetShipmentDetails.HeaderInfo.CallerID,c=l.InputGetShipmentDetails.P_ORG_ID,I=l.InputGetShipmentDetails.P_DELIVERY_NUM,f=u.DELIVERY_DETAIL_KEY+":"+a+":"+p+":"+D+":"+c+":"+I;return i.isEnabled()&&i.isOffline()?(t.getJSON("js/app/pages/delivery/deliveryDetailMock.json",function(e){setTimeout(function(){s.resolve(e,{status:200})},500)}),f):(console.log("[Amplify Request] Delivery Detail - "+f),n.request({resourceId:u.DELIVERY_DETAIL_KEY,success:s.resolve,error:s.reject,data:r}),t.when(s).done(function(e,t,n){o.setLocalStorage(f,e),o.updateDownloadRequestCount(u.P_DELIVERY_DTL_CNT,1)}).fail(function(){o.updateDownloadRequestCount(u.P_DELIVERY_DTL_CNT,1)}),f)}this.registerService=function(e){return r(e)}}return new l});