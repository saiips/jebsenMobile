define(["ojs/ojcore","knockout","jquery","amplify","appController","util/errorhandler","hammerjs","lzstring","ojs/ojdialog"],function(o,e,t,n,a,s,i,r){"use strict";function l(){function i(){l.msgBoxModel=new f,e.applyBindings(l.msgBoxModel,document.getElementById("toastDialogWrapper"))}var l=this;l.showBusy=function(){null==c&&(c=t("#busy")),c.is(":hidden")&&!s.hasError()&&c.show()},l.hideBusy=function(){null==c&&(c=t("#busy"));var o=t.Deferred();return c.is(":visible")&&c.fadeOut(300,o.resolve),t.when(o)},l.showAppError=function(o){s.setError(o),setTimeout(function(){s.clearError()},2e3)},l.showMessageBox=function(o,e){l.showDialog(e,"",null,o,!0)},l.showErrorDialog=function(o){l.showDialog(o,"toast-bg-cross",2e3)},l.toast=function(o,e,t){t&&(t=2e3),l.showDialog(o,e,t)},l.showDialog=function(o,e,t,n,a){l.msgBoxModel.updateModel(o,e,n,a),l.msgBoxModel.open(t)},l.addSwipeActionsToList=function(e,n,a){var s=t(e);s.find(n).each(function(e,n){var s=t(this).prop("id"),i=t(n),r=i.find(".oj-offcanvas-start").first(),l=i.find(".oj-offcanvas-end").first();!function(e,t){if(t){var n=function(){var t=e.find(".oj-offcanvas-inner-wrapper").first();t&&setTimeout(function(){t.addClass(o.OffcanvasUtils.TRANSITION_SELECTOR),o.OffcanvasUtils._setTransform(t,"")},0)};t.on("ojclose",n),e.data("ojCloseDrawerFn",n)}}(i,l),o.SwipeToRevealUtils.setupSwipeActions(r),o.SwipeToRevealUtils.setupSwipeActions(l),l.off("ojdefaultaction"),l.on("ojdefaultaction",function(){a.handleDefaultAction({id:s})})})},l.removeSwipeActionsFromList=function(e,n){var a=t(e);a.find(n).each(function(e,n){var a=t(n),s=a.find(".oj-offcanvas-start").first(),i=a.find(".oj-offcanvas-end").first(),r=a.data("ojCloseDrawerFn");r&&(i.off("ojclose",r),a.removeData("ojCloseDrawerFn")),o.SwipeToRevealUtils.tearDownSwipeActions(s),o.SwipeToRevealUtils.tearDownSwipeActions(i)})},l.hideSwipeCanvas=function(e){o.OffcanvasUtils.close({displayMode:"push",selector:e})},l.getLocalStorage=function(o){var e=n.store.localStorage(o);if("string"==typeof e)if(null==e||"undefined"==typeof e)e=null;else{var t=r.decompressFromUTF16(e);try{var a=JSON.parse(t);e=a}catch(o){e=t}}return e},l.setLocalStorage=function(o,e){if(null==e||"undefined"==typeof e)return n.store.localStorage(o,null);try{var t;t="string"==typeof e?r.compressToUTF16(e):r.compressToUTF16(JSON.stringify(e)),n.store.localStorage(o,t)}catch(o){console.log("error : "+o)}},l.updateDownloadRequestCount=function(o,e){var t=a.moduleConfig.params.rootContext.initLoadMap;"undefined"!=typeof t&&t||(t={},a.moduleConfig.params.rootContext.initLoadMap=t),"undefined"==typeof t[o]?t[o]=new Number(e):t[o]=new Number(t[o])+new Number(e),a.moduleConfig.params.rootContext.initLoadMap=t,a.moduleConfig.params.rootContext.completedRequest+=1,console.log("Request of data download completed (completedRequest) = "+a.moduleConfig.params.rootContext.completedRequest)},i()}function f(){var n=this,a=o.Translations.getTranslatedString,s=t(u);n.messageText=e.observable(),n.headerIcon=e.observable(),n.titleText=e.observable(),n.showOK=e.observable(!1),n.modality=e.observable(),n.okText=a("ssa.menu.okay"),n.updateModel=function(o,e,t,a){n.messageText(o),n.headerIcon(e?"placeholder "+e:""),n.titleText(t),n.showOK(a),n.modality(a?"modal":"modeless")},n.handleOKClose=function(){n.close()},n.close=function(){s.ojDialog("close")},n.open=function(o){if(s.ojDialog(),s.ojDialog("open"),document.activeElement.blur(),o){var e=t(d);setTimeout(function(){e.fadeOut("slow",function(){e.show(),n.close()})},o)}}}var c=null,u="#toastDialog",d="#ojDialogWrapper-toastDialog";return new l});